# DESCRIPTION: 	
# Builds, tests, and packages the solution for all PR requests.	

name: $(SourceBranchName)-$(Date:yyyyMMdd)$(Rev:-r)

variables:
- template: ci-variables.yml
- template: build-variables.yml

stages:
- template: build-deploy.yml

- stage: securityScan
  displayName: Security Scan
  dependsOn: []
  jobs:
  - job: runScan
    pool:
      vmImage: $(WindowsVmImage)
    steps:
    - task: securedevelopmentteam.vss-secure-development-tools.build-task-antimalware.AntiMalware@3
      displayName: 'Run MpCmdRun.exe'
      inputs:
        FileDirPath: '$(System.ArtifactsDirectory)'
        EnableServices: true
        SignatureFreshness: OneDay
        TreatStaleSignatureAs: Warning


parameters:
- name: version
  type: string
- name: sql
  type: boolean
  default: false
- name: deploymentEnvironmentName
  type: string
- name: subscription
  type: string
- name: clusterName
  type: string
- name: clusterResourceGroup
  type: string
- name: testEnvironmentUrl
  type: string
- name: imageTag
  type: string

jobs:
- job: provisionEnvironment
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - task: AzureKeyVault@1
    displayName: 'Azure Key Vault: resolute-oss-tenant-info'
    inputs:
      azureSubscription: $(ConnectedServiceName)
      KeyVaultName: 'resolute-oss-tenant-info'

  - task: AzureCLI@2
    displayName: 'Azure CLI: InlineScript'
    inputs:
      azureSubscription: $(ConnectedServiceName)
      ScriptType: inlineScript
      Inline: |
        az aks get-credentials --name ${{parameters.clusterName}} --resource-group ${{parameters.clusterGroupName}}
        kubectl get nodes
        helm list